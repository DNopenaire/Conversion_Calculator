<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Convertisseur Adresse IP</title>
  <style>
    body {
      background-color: #2e2e2e;
      color: #ffffff;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    input, button {
      font-size: 14px;
      padding: 8px;
      margin: 5px;
      background-color: #3e3e3e;
      color: #ffffff;
      border: none;
      border-radius: 4px;
    }
    button {
      background-color: #444444;
      cursor: pointer;
    }
    #result {
      margin-top: 20px;
      color: #00ffcc;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>Convertisseur Adresse IP</h2>
  <p>Entrez une adresse IP, binaire, hexadécimale ou décimale :</p>
  <input type="text" id="input" size="40" placeholder="Ex: 192.168.0.1 ou C0A80001">
  <br>

  <div id="buttons"></div>
  <div id="result"></div>

  <script>
    function normaliserIP(ip) {
      let octets = ip.trim().split('.');
      while (octets.length < 4) octets.push('0');
      return octets.slice(0, 4).join('.');
    }

    function ipVersBinaire(ip) {
      ip = normaliserIP(ip);
      let octets = ip.split('.');
      try {
        let bin = octets.map(o => {
          let n = parseInt(o);
          if (n < 0 || n > 255) throw "Erreur";
          return n.toString(2).padStart(8, '0');
        });
        return bin.join('.');
      } catch {
        return "Erreur : IP invalide.";
      }
    }

    function binaireVersIP(binaire) {
      binaire = binaire.replace(/\./g, '').padStart(32, '0');
      let octets = [];
      for (let i = 0; i < 32; i += 8) {
        octets.push(binaire.slice(i, i + 8));
      }
      try {
        let ip = octets.map(b => parseInt(b, 2));
        return ip.join('.');
      } catch {
        return "Erreur : Format binaire incorrect.";
      }
    }

    function ipVersHex(ip) {
      ip = normaliserIP(ip);
      let octets = ip.split('.');
      try {
        let hex = octets.map(o => parseInt(o).toString(16).padStart(2, '0'));
        return "0x" + hex.join('').toUpperCase();
      } catch {
        return "Erreur : IP invalide.";
      }
    }

    function ipVersDecimal(ip) {
      ip = normaliserIP(ip);
      let octets = ip.split('.');
      try {
        return octets.reduce((acc, o, i) => acc + (parseInt(o) << (8 * (3 - i))), 0).toString();
      } catch {
        return "Erreur : IP invalide.";
      }
    }

    function binaireVersHex(binaire) {
      let ip = binaireVersIP(binaire);
      return ip.startsWith("Erreur") ? ip : ipVersHex(ip);
    }

    function binaireVersDecimal(binaire) {
      binaire = binaire.replace(/\./g, '');
      if (!/^[01]+$/.test(binaire)) return "Erreur : Binaire invalide.";
      return parseInt(binaire.padStart(32, '0'), 2).toString();
    }

    function hexVersIP(hex) {
      hex = hex.replace(/^0x/i, '').padStart(8, '0');
      try {
        let ip = [];
        for (let i = 0; i < 8; i += 2) {
          ip.push(parseInt(hex.slice(i, i+2), 16));
        }
        return ip.join('.');
      } catch {
        return "Erreur : Format hexadécimal incorrect.";
      }
    }

    function hexVersBinaire(hex) {
      let ip = hexVersIP(hex);
      return ip.startsWith("Erreur") ? ip : ipVersBinaire(ip);
    }

    function hexVersDecimal(hex) {
      let ip = hexVersIP(hex);
      return ip.startsWith("Erreur") ? ip : ipVersDecimal(ip);
    }

    function decimalVersIP(dec) {
      try {
        let n = parseInt(dec);
        if (n < 0 || n > 4294967295) throw "Erreur";
        return [3,2,1,0].map(i => (n >> (8*i)) & 255).join('.');
      } catch {
        return "Erreur : Valeur décimale hors plage.";
      }
    }

    function decimalVersHex(dec) {
      let ip = decimalVersIP(dec);
      return ip.startsWith("Erreur") ? ip : ipVersHex(ip);
    }

    function decimalVersBinaire(dec) {
      let ip = decimalVersIP(dec);
      return ip.startsWith("Erreur") ? ip : ipVersBinaire(ip);
    }

    const conversions = {
      "IP → Binaire": ipVersBinaire,
      "IP → Hexadécimal": ipVersHex,
      "IP → Décimal": ipVersDecimal,
      "Binaire → IP": binaireVersIP,
      "Binaire → Hexadécimal": binaireVersHex,
      "Binaire → Décimal": binaireVersDecimal,
      "Hexadécimal → Binaire": hexVersBinaire,
      "Hexadécimal → IP": hexVersIP,
      "Hexadécimal → Décimal": hexVersDecimal,
      "Décimal → IP": decimalVersIP,
      "Décimal → Hexadécimal": decimalVersHex,
      "Décimal → Binaire": decimalVersBinaire
    };

    const buttonsDiv = document.getElementById("buttons");
    for (let [label, func] of Object.entries(conversions)) {
      let btn = document.createElement("button");
      btn.textContent = label;
      btn.onclick = () => {
        let input = document.getElementById("input").value;
        let output = func(input);
        document.getElementById("result").textContent = `${label} : ${output}`;
      };
      buttonsDiv.appendChild(btn);
    }
  </script>
</body>
</html>
